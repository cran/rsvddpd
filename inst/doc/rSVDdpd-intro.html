<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to rSVDdpd</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to rSVDdpd</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(rsvddpd)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(pcaMethods)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Loading required package: Biobase</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; Loading required package: BiocGenerics</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; Loading required package: generics</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;generics&#39;</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt;     as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt;     setequal, union</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;BiocGenerics&#39;</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt;     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt;     as.data.frame, basename, cbind, colnames, dirname, do.call,</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt;     duplicated, eval, evalq, get, grep, grepl, is.unsorted, lapply,</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt;     mapply, match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt;     rank, rbind, rownames, sapply, saveRDS, table, tapply, unique,</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co">#&gt;     unsplit, which.max, which.min</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">#&gt; Welcome to Bioconductor</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">#&gt;     Vignettes contain introductory material; view with</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#&gt;     &#39;browseVignettes()&#39;. To cite Bioconductor, see</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co">#&gt;     &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;.</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;Biobase&#39;</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:matrixStats&#39;:</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="co">#&gt;     anyMissing, rowMedians</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;pcaMethods&#39;</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="co">#&gt;     loadings</span></span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Singular Value Decomposition (SVD) is a very popular technique which
is abundantly used in different applications from Bioinformatics, Image
and Signal processing, Textual Analysis, Dimensional Reduction
techniques etc.</p>
<p>However, it is often the case that the data matrix, on which SVD is
generally applied on, contains outliers which are not in accord with the
data generating mechanism. In such a case, usual SVD performs poorly in
a sense that the singular values and the left and right singular vectors
are found to be very different from the ones that would have been
obtained if the data matrix was free of outliers. Hence, the dire need
of a robust version of SVD is extremely prevalent, since hardly any data
in practice becomes free of any type of outliers.</p>
<p>For illustration, consider the simple <span class="math inline">\(4\times 3\)</span> matrix, where the elements go
from <span class="math inline">\(1\)</span> to <span class="math inline">\(12\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>X</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; [1,]    1    2    3</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; [2,]    4    5    6</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; [3,]    7    8    9</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; [4,]   10   11   12</span></span></code></pre></div>
<p>and the singular value decomposition turns out the singular values as
approximately <span class="math inline">\(25, 1.3\)</span> and <span class="math inline">\(0\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">svd</span>(X)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; [1] 2.546241e+01 1.290662e+00 1.843192e-15</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; $u</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;            [,1]        [,2]       [,3]</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; [1,] -0.1408767 -0.82471435  0.5458544</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; [2,] -0.3439463 -0.42626394 -0.6941158</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; [3,] -0.5470159 -0.02781353 -0.2493314</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; [4,] -0.7500855  0.37063688  0.3975929</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; $v</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;            [,1]        [,2]       [,3]</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; [1,] -0.5045331  0.76077568 -0.4082483</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; [2,] -0.5745157  0.05714052  0.8164966</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; [3,] -0.6444983 -0.64649464 -0.4082483</span></span></code></pre></div>
<p>Now, note what happens when we contaminate a single entry of the
matrix by a large outlying value.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>X[<span class="dv">2</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">svd</span>(X)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [1] 101.431313  18.313121   1.148165</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; $u</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;             [,1]       [,2]          [,3]</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; [1,] -0.02260136  0.1500488  0.9516017926</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; [2,] -0.98805726 -0.1540849  0.0008289283</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; [3,] -0.08969187  0.5758535  0.1322532569</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; [4,] -0.12323712  0.7887559 -0.2774210109</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; $v</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;             [,1]        [,2]         [,3]</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; [1,] -0.05752705  0.62535728 -0.778215212</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; [2,] -0.99499917 -0.09966888 -0.006539692</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; [3,] -0.08165348  0.77394728  0.627963626</span></span></code></pre></div>
<p>All the singular values are now much different, being <span class="math inline">\(101.4, 18.3\)</span> and <span class="math inline">\(1.14\)</span>. However, in practical cases, where
<span class="math inline">\(X\)</span> actually represent a data matrix,
this can pose a serious problem.</p>
<p>On the other hand, using <code>rSVDdpd</code> function from
<code>rsvddpd</code> package enables us a mitigate the effect of this
outlier.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X)))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; [1] 25.47298486  1.29013017  0.02811386</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; $u</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; [1,] 0.1408239  0.82504019  0.4775446</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3450082  0.42538716 -0.8366691</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; [3,] 0.5467886  0.02772993  0.2395725</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; [4,] 0.7497734 -0.37092520  0.1205864</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; $v</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; [1,] 0.5043111 -0.76326254  0.4038571</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; [2,] 0.5749972 -0.05210484 -0.8164946</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; [3,] 0.6442426  0.64398399  0.4125967</span></span></code></pre></div>
<p>Since the function does some randomized initialization under the
hood, the result might not be exactly same when you run the code again.
However, you should get the singular values pretty close to the singular
values of the original <span class="math inline">\(X\)</span> before we
added the outlier.</p>
<hr />
</div>
<div id="theoretical-background" class="section level1">
<h1>Theoretical Background</h1>
<p>Let us take a look at what <code>rSVDdpd</code> does under the hood.
Before that, singular value decomposition (SVD) of a matrix <span class="math inline">\(X\)</span> is splitting it as;</p>
<p><span class="math display">\[X_{n\times p} = U_{n \times r}
D_{r\times r}V_{p\times r}^T\]</span> Here, <span class="math inline">\(r\)</span> is the rank of the matrix <span class="math inline">\(X\)</span>, <span class="math inline">\(D\)</span>
is a diagonal matrix with non-negative real entries, and <span class="math inline">\(U, V\)</span> are orthogonal matrices. Since, we
usually observe data matrix <span class="math inline">\(X\)</span> with
errors, the model ends up being <span class="math inline">\(X = UDV^T +
\epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span>
is the errors.</p>
<p>For simplicity, we consider <span class="math inline">\(r =
1\)</span>, i.e. <span class="math inline">\(X \approx \lambda
ab^T\)</span>, where <span class="math inline">\(a, b\)</span> are
vectors of appropriate dimensions. The usual SVD can be viewed as
solving the problem <span class="math inline">\(\sum_{i, j} (X_{ij} -
\lambda a_i b_j)^2\)</span>, with respect to the choices of <span class="math inline">\(a_i, b_j\)</span>’s and <span class="math inline">\(\lambda\)</span>. This <span class="math inline">\(L_2\)</span> norm is essentially susceptible to
outliers, hence people have generally tried to use <span class="math inline">\(L_1\)</span> norm instead and tried to minimize
that.</p>
<p>Here, we use Density Power Divergence (which is popularly used in
robust estimation techniques bridging robustness and efficiency) to
quantify the norm of the error. In particular, we try to minimize the
function,</p>
<p><span class="math display">\[
H = \int \phi\left( \dfrac{x - \lambda a_ib_j}{\sigma} \right)^{(1 +
\alpha)}dx - \dfrac{1}{np} \sum_{i=1}^{n} \sum_{j = 1}^{p} \phi\left(
\dfrac{X_{ij} - \lambda a_ib_j}{\sigma} \right)^{\alpha}
\]</span> with respect to the unknowns <span class="math inline">\(\lambda, a_i, b_j\)</span> and <span class="math inline">\(\sigma^2\)</span>, where <span class="math inline">\(\phi(\cdot)\)</span> is the standard normal
density function. However, since the above problem is actually
non-convex, but is convex when one of <span class="math inline">\(a_i\)</span>’s or <span class="math inline">\(b_j\)</span>’s are held fixed, we iterate between
situations fixing <span class="math inline">\(a_i\)</span>’s and <span class="math inline">\(b_j\)</span>’s and finding minimum of the other
quantities respectively.</p>
<hr />
</div>
<div id="features" class="section level1">
<h1>Features</h1>
<div id="underflow-and-overflow" class="section level2">
<h2>Underflow and Overflow</h2>
<p>Because of the usage of standard normal density, and exponential
functions, the usual algorithm suffers from underflow and overflow and
the estimates tend to become <code>NAN</code> or <code>Inf</code> in
some iterations for reasonably large or reasonably small values in the
data matrix. To deal with this, <code>rSVDdpd</code> function first
scales all elements of the data matrix to a suitable range, and then
perform the robust SVD algorithm. Finally, the scaling factor can be
adjusted to obtain the original singular values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">rSVDdpd</span>(X <span class="sc">*</span> <span class="fl">1e6</span>, <span class="at">alpha  =</span> <span class="fl">0.3</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X)))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; [1] 25472985.52  1290130.10    28117.05</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; $u</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; [1,] 0.1408239 -0.82504023  0.4775445</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3450084 -0.42538703 -0.8366690</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; [3,] 0.5467885 -0.02772991  0.2395726</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; [4,] 0.7497734  0.37092526  0.1205866</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; $v</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; [1,] 0.5043111  0.76326290  0.4038565</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; [2,] 0.5749972  0.05210412 -0.8164946</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; [3,] 0.6442426 -0.64398363  0.4125973</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="fu">rSVDdpd</span>(X <span class="sc">*</span> <span class="fl">1e-6</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X)))</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; [1] 2.547298e-05 1.290130e-06 2.810094e-08</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; $u</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; [1,] 0.1408240 -0.82504003  0.4775449</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3450074 -0.42538768 -0.8366691</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; [3,] 0.5467887 -0.02773004  0.2395721</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; [4,] 0.7497737  0.37092496  0.1205857</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; $v</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; [1,] 0.5043112  0.76326109  0.4038598</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; [2,] 0.5749970  0.05210776 -0.8164945</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; [3,] 0.6442427 -0.64398548  0.4125943</span></span></code></pre></div>
<p>As it can be seen, the function <code>rSVDdpd</code> handles the very
large or very small elements nicely.</p>
</div>
<div id="permutation-invariance" class="section level2">
<h2>Permutation Invariance</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X[, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">rSVDdpd</span>(Y, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(Y)))</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; [1] 25.47297861  1.29013087  0.02808331</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; $u</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; [1,] 0.1408240  0.82503980  0.4775452</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3450063  0.42538839 -0.8366692</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; [3,] 0.5467890  0.02773019  0.2395715</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [4,] 0.7497740 -0.37092463  0.1205847</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; $v</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]       [,3]</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; [1,] 0.6442427  0.64398750  0.4125911</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; [2,] 0.5043113 -0.76325911  0.4038634</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; [3,] 0.5749969 -0.05211174 -0.8164943</span></span></code></pre></div>
<p>As expected, the singular values do not change when the columns of
the data matrix is permuted, however, the singular vector permutes in
the same manner of the permutation of the columns.</p>
</div>
<div id="orthogonality-of-left-and-right-singular-vectors" class="section level2">
<h2>Orthogonality of Left and Right Singular vectors</h2>
<p>An important property of SVD is that the matrix corresponding to the
left and right singular vectors are orthogonal matrices. A sanity check
of this property can also be verified very easily.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">crossprod</span>(<span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X)))<span class="sc">$</span>u)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;              [,1]         [,2]         [,3]</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; [1,] 1.000000e+00 5.450780e-18 1.290471e-17</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; [2,] 5.450780e-18 1.000000e+00 8.474283e-17</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; [3,] 1.290471e-17 8.474283e-17 1.000000e+00</span></span></code></pre></div>
<p>As it seems, the off diagonal entries are very small values. This is
ensured by introducing a Gram Schimdt Orthogonalization step between
successive iterations of the algorithm.</p>
</div>
<div id="effect-of-robustness-parameter" class="section level2">
<h2>Effect of Robustness Parameter</h2>
<p>In presence of outliers with large deviation, the performance of
<code>rSVDdpd</code> is fairly robust to the choice of <span class="math inline">\(\alpha\)</span>, the robustness parameter. With
<span class="math inline">\(\alpha = 0\)</span>, <code>rSVDdpd</code>
corresponds to usual <code>svd</code> function from <code>base</code>
package. However, with increasing <span class="math inline">\(\alpha\)</span>, the robustness increases,
i.e. even a smaller deviation would not affect the singular values,
while with higher <span class="math inline">\(\alpha\)</span>, the
variance of the estimators generally increase.</p>
<p>To demonstrate the effect of <span class="math inline">\(\alpha\)</span> on time complexity,
<code>microbenchmark</code> package will be used.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="fu">svd</span>(X), </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                               <span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X))), </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                               <span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X))), </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                               <span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X))), </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                               <span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X))), </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                               <span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X))), <span class="at">times =</span> <span class="dv">30</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt;                                        expr    min     lq     mean median</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;                                      svd(X)  7.749  8.200  8.84780  8.405</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;     rSVDdpd(X, alpha = 0, nd = min(dim(X))) 20.705 21.197 22.90670 21.402</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;  rSVDdpd(X, alpha = 0.25, nd = min(dim(X))) 21.771 22.140 22.67027 22.427</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;   rSVDdpd(X, alpha = 0.5, nd = min(dim(X))) 22.181 22.591 23.37410 22.960</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt;  rSVDdpd(X, alpha = 0.75, nd = min(dim(X))) 21.566 22.632 23.18277 22.960</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt;     rSVDdpd(X, alpha = 1, nd = min(dim(X))) 22.345 23.083 23.63240 23.452</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt;      uq    max neval</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;   8.692 20.254    30</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;  21.894 64.206    30</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt;  22.919 26.035    30</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt;  23.903 28.782    30</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt;  23.534 25.707    30</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt;  23.903 27.839    30</span></span></code></pre></div>
<p>Therefore, the execution time slightly increases with higher <span class="math inline">\(\alpha\)</span>.</p>
<hr />
</div>
</div>
<div id="comparison-with-existing-packages" class="section level1">
<h1>Comparison with existing packages</h1>
<p>To compare performances of usual SVD algorithm with that of
<code>rSVDdpd</code>, one can use <code>simSVD</code> function, which is
used to simulate data matrices based on a model and then obtain an
estimate of Bias and MSE of the estimates using a Monte Carlo
approach.</p>
<p>First, we create the true data matrix, with singular vectors taken
from coefficients of orthogonal polynomials.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stats<span class="sc">::</span><span class="fu">contr.poly</span>(<span class="dv">10</span>)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stats<span class="sc">::</span><span class="fu">contr.poly</span>(<span class="dv">4</span>)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>trueSVD <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">3</span>), <span class="at">u =</span> U, <span class="at">v =</span> V)  <span class="co"># true svd of the data matrix</span></span></code></pre></div>
<p>We can now call <code>simSVD</code> function to see the performance
of usual SVD algorithm under contamination from outlier.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simSVD</span>(trueSVD, <span class="at">svdfun =</span> svd, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">2021</span>, <span class="at">outlier =</span> <span class="cn">TRUE</span>, <span class="at">out_value =</span> <span class="dv">25</span>, <span class="at">tau =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>res</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [1] 28.20376 21.39073 11.20089</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; $MSE</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; [1] 845.4570 527.2264 208.7107</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; [1] 50.00523 69.66283 83.25073</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; $Left</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [1] 0.6713628 0.7145263 0.7491816</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; $Right</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.5724405 0.5660693 0.6095304</span></span></code></pre></div>
<p>Following is the performance of <code>robustSvd</code> function from
<code>pcaMethods</code> package.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simSVD</span>(trueSVD, <span class="at">svdfun =</span> pcaMethods<span class="sc">::</span>robustSvd, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">2021</span>, <span class="at">outlier =</span> <span class="cn">TRUE</span>, <span class="at">out_value =</span> <span class="dv">25</span>, <span class="at">tau =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>res</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; [1] 18.05765 15.33612 15.38991</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; $MSE</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; [1] 538.5657 396.1253 356.9578</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; [1] 212.4870 160.9287 120.1086</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; $Left</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; [1] 0.4832931 0.6693124 0.6969779</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; $Right</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.4295419 0.5462049 0.5159212</span></span></code></pre></div>
<p>Now we compare <code>rSVDdpd</code> function’s performance with the
other SVD implementations.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>rSVDdpd_max <span class="ot">&lt;-</span> <span class="cf">function</span>(X, alpha) {</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rSVDdpd</span>(X, <span class="at">alpha =</span> alpha, <span class="at">nd =</span> <span class="fu">min</span>(<span class="fu">dim</span>(X))))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>}</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simSVD</span>(trueSVD, <span class="at">svdfun =</span> rSVDdpd_max, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">2021</span>, <span class="at">outlier =</span> <span class="cn">TRUE</span>, <span class="at">out_value =</span> <span class="dv">25</span>, <span class="at">tau =</span> <span class="fl">0.9</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>res</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; [1]  3.47466190  0.05686266 -0.22769722</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; $MSE</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; [1] 104.9849391   0.6843969   0.2378147</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; [1] 92.9116638  0.6811636  0.1859687</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; $Left</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; [1] 0.08385757 0.09691123 0.10080858</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; $Right</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.05255743 0.07546599 0.08511308</span></span></code></pre></div>
<p>And with <span class="math inline">\(\alpha = 0.75\)</span>, we
have;</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simSVD</span>(trueSVD, <span class="at">svdfun =</span> rSVDdpd_max, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">2021</span>, <span class="at">outlier =</span> <span class="cn">TRUE</span>, <span class="at">out_value =</span> <span class="dv">25</span>, <span class="at">tau =</span> <span class="fl">0.9</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>res</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; $Bias</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; [1]  0.1903417 -0.1843705 -0.2716241</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; $MSE</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4822773 0.1357128 0.1671783</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.44604734 0.10172035 0.09339867</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; $Left</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; [1] 0.01421574 0.03210005 0.04942867</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; $Right</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.006691835 0.020217527 0.029774606</span></span></code></pre></div>
<p>As it can be seen, the bias and MSE are much lesser in
<code>rSVDdpd</code> algorithm.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
